var OOCSI=(function(){var i="ws://localhost:9000/";var p;var m={};var l;var b=false;function c(){l=new WebSocket(i);l.onopen=function(q){j(q)};l.onclose=function(q){k(q)};l.onmessage=function(q){h(q)};l.onerror=function(q){e(q)}}function j(q){if(l.readyState==WebSocket.OPEN){g(p);b=true}d("CONNECTED")}function k(q){d("DISCONNECTED")}function h(r){try{var q=JSON.parse(r.data);if(m[q.recipient]!==undefined){m[q.recipient](q)}else{d("no handler for event: "+r.data)}}catch(q){d("parse exception for event: "+r.data)}d("RESPONSE: "+r.data)}function e(q){d("ERROR: "+q.data)}function a(){l&&l.close()}function g(q){if(l&&l.send(q)){d("SENT: "+q)}}function d(q){console.log(q)}function f(r,q){b&&g("sendjson "+r+" "+JSON.stringify(q))}function n(q,r){if(b){g("subscribe "+q);m[q]=r}}function o(q){if(b){g("unsubscribe "+q);m[q]=function(){}}}return{connect:function(q,s,r){i=q;p=s;m[s]=r;c()},send:function(r,q){f(r,q)},subscribe:function(q,r){n(q,r)},unsubscribe:function(q){o(q)},close:function(){a()},handlers:function(){return m}}})();